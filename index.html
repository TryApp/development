<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <title>AppBox</title>
  <link rel="stylesheet" href="css/framework7.ios.min.css">
  <link rel="stylesheet" href="css/my-app.css">
</head>

<body>
  <!-- Status bar overlay for fullscreen mode-->
  <div class="statusbar-overlay"></div>
  <!-- Panels overlay-->
  <div class="panel-overlay"></div>
  <!-- Left panel with reveal effect-->
  <div class="panel panel-left panel-cover">
    <!-- Left view-->
    <div class="view view-left navbar-through">
      <div class="navbar">
        <div class="navbar-inner">
          <div class="left"></div>
          <div class="center sliding">AppBox</div>
          <div class="right"></div>
        </div>
      </div>
      <div class="pages">
        <div data-page="index-left" class="page">
          <div class="page-content">
            <div class="content-block-title">AppBox</div>
            <div class="list-block">
              <ul>
                <li>
                  <a href="about.html" data-view=".view-main" class="item-link close-panel">
                    <div class="item-content">
                      <div class="item-inner">
                        <div class="item-title">About</div>
                      </div>
                    </div>
                  </a>
                </li>
                <li>
                  <a href="help.html" data-view=".view-main" class="item-link close-panel">
                    <div class="item-content">
                      <div class="item-inner">
                        <div class="item-title">Help</div>
                      </div>
                    </div>
                  </a>
                </li>
                <li>
                    <a href="http://www.tryappbox.com" data-view=".view-main" class="item-link close-panel">
                      <div class="item-content">
                        <div class="item-inner">
                          <div class="item-title">Website</div>
                        </div>
                      </div>
                    </a>
                  </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Right panel with cover effect-->
  <div class="panel panel-right panel-reveal">
    <div class="content-block">
      <p>Right panel content goes here</p>
    </div>
  </div>
  <!-- Views-->
  <div class="views">
    <!-- Right view, it is main view-->
    <div class="view view-main navbar-through">
      <div class="navbar">
        <div class="navbar-inner">
          <div id="appTitle" class="center sliding">Main View</div>
          <div class="right"><a href="#" data-panel="left" class="link open-panel icon-only"><i class="icon icon-bars"></i></a></div>
        </div>
      </div>
      <!-- Pages-->
      <div class="pages">
        <!-- Page, data-page contains page name-->
        <div data-page="index-1" class="page">
          <!-- Scrollable page content-->
          <div class="page-content">
            <div class="content-block-title">APP OVERVIEW</div>
            <div class="list-block">
              <ul>
                <li>
                  <div class="item-content">
                    <div class="item-inner">
                      <div class="item-title">Bundle Identifier</div>
                      <div id="appIdentifier" class="item-after">1.0</div>
                    </div>
                  </div>
                </li>
                <li>
                  <div class="item-content">
                    <div class="item-inner">
                      <div class="item-title">Version</div>
                      <div id="appVersion" class="item-after">1.0</div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
            <div class="content-block-title">INSTALLATION</div>
            <div class="list-block">
              <ul>
                <li>
                  <a href="download.html" class="item-link">
                    <div class="item-content">
                      <div class="item-inner">
                        <div id="installButton" class="item-title">Install Latest Version</div>
                      </div>
                    </div>
                  </a>
                </li>
                <li id="showAllBuildButton">
                  <a href="all.html" class="item-link">
                    <div class="item-content">
                      <div class="item-inner">
                        <div class="item-title">Install Previous Version(s)</div>
                      </div>
                    </div>
                  </a>
                </li>
                <li>
                  <a href="qr.html" class="item-link">
                    <div class="item-content">
                      <div class="item-inner">
                        <div id="showQRCodeButton" class="item-title">Show QR Code</div>
                      </div>
                    </div>
                  </a>
                </li>
              </ul>
            </div>
            <center>
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <ins class="adsbygoogle"
                   data-ad-client="ca-pub-3139212365885959"
                   data-ad-slot="5702922209"
                   data-ad-format="auto"></ins>
                <script>
                  window.onload = function() {
                    (adsbygoogle = window.adsbygoogle || []).push({});
                  }
                </script>
            </center>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script>
    var qrStr = window.location.search;
    qrStr = qrStr.split("?url=")[1];
    var menifestLinkPath = qrStr;
    if (qrStr) {
      if (qrStr.indexOf('manifest.plist') != -1) {
        var client = new XMLHttpRequest();
        client.timeout = 60000;
        client.onreadystatechange = function () {
          if (client.readyState == 4 && client.status == 200) {
            try {
              menifestLinkPath = qrStr;
              var response = client.responseText.replace(new RegExp(/[^a-zA-Z0-9.]/g), '');
              var first = response.split('stringkeytitlekeystring')[1].toString().split('string')[0];
              var appTitle = response.split('stringkeytitlekeystring')[1].toString().split('string')[0];
              var appIdentifier = response.split('keybundleidentifierkeystring')[1].toString().split('string')[0];
              var appVersion = response.split('stringkeybundleversionkeystring')[1].toString().split('string')[0];
              document.getElementById('appTitle').textContent = appTitle;
              document.getElementById('appVersion').textContent = appVersion;
              document.getElementById('appIdentifier').textContent = appIdentifier;
              document.getElementById('installButton').textContent = "Install Application";
              document.getElementById('mainDiv').hidden = false;
              document.getElementById('loaderDiv').hidden = true;
              document.getElementById('showAllBuildButton').hidden = true;
              document.title = appTitle + " | AppBox";
              //trackPageName();
              //updateInstallationMessage(appTitle);
            }
            catch (err) {
              //showErrorUI();
            }
          } else if (client.status >= 400) {
            //showErrorUI();
          }
        };
        client.open('GET', 'https://dl.dropboxusercontent.com' + qrStr);
        client.setRequestHeader('Content-Type', 'text/xml');
        client.overrideMimeType('text/xml')
        client.send();
      } else if (qrStr.indexOf('appinfo.json') != -1) {
        var client = new XMLHttpRequest();
        client.timeout = 60000;
        client.onreadystatechange = function () {
          if (client.readyState == 4 && client.status == 200) {
            try {
              var response = JSON.parse(client.responseText);
              menifestLinkPath = response.latestVersion.manifestLink.split("dropbox.com")[1];
              var first = response.latestVersion.build;
              var appTitle = response.latestVersion.name;
              var appIdentifier = response.latestVersion.identifier;
              var appVersion = response.latestVersion.version;
              document.getElementById('appTitle').textContent = appTitle;
              document.getElementById('appVersion').textContent = appVersion;
              document.getElementById('appIdentifier').textContent = appIdentifier;
              document.title = appTitle + " | AppBox";
              //trackPageName();
              //updateInstallationMessage(appTitle);
              if (response.versions.length > 1) {
                document.getElementById('installButton').textContent = "Install Latest Version";
                updatePreviousBuild(response.versions);
              } else {
                document.getElementById('installButton').textContent = "Install Application";
                document.getElementById('showAllBuildButton').hidden = true;
              }
              document.getElementById('mainDiv').hidden = false;
              document.getElementById('loaderDiv').hidden = true;
            }
            catch (err) {
              //showErrorUI();
            }
          } else if (client.status >= 400) {
            //showErrorUI();
          }
        };
        client.open('GET', 'https://dl.dropboxusercontent.com' + qrStr);
        client.setRequestHeader('Content-Type', 'text/xml');
        client.overrideMimeType('text/xml')
        client.send();
      } else {
        //showErrorUI();
      }
    } else {
      //appPage();
    }
  </script>

  <script type="text/javascript" src="js/framework7.min.js"></script>
  <script type="text/javascript" src="js/my-app.js"></script>
</body>

</html>